{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","Component","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","window","test","type","size","error","Promise","resolve","reject","upload","then","serverfile","console","log","catch","tip","spinning","isUploading","className","InboxOutlined","target","href","filename","src","placeholder","ref","onChange","current","value","fullStr","Tips","children","Home","Uploader"],"mappings":"4jBAQOA,EAAWC,IAAXD,QAEDE,EAASC,IAAOC,IAAV,KAMNC,EAAKF,IAAOG,GAAV,KAKFC,EAAQJ,IAAOK,IAAV,KA+HIC,EAzHGC,aAAS,WAAO,IAAD,EACCC,cAAzBC,EADwB,EACxBA,WAAYC,EADY,EACZA,UAEbC,EAAOC,mBACPC,EAAOD,mBAEPE,EAAQC,aAAc,iBAAO,CACjCC,MAAO,KACPC,SAFiC,SAExBD,GACPF,EAAME,MAAQA,GAEhB,eACE,OAAOF,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE7CE,OAAQ,KACRC,UATiC,SASvBD,GACRJ,EAAMI,OAASA,GAEjB,gBACE,OAAOJ,EAAMI,OAAN,aAAqBJ,EAAMI,QAAW,IAE/C,cACE,OAAOT,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eAGpGC,EAAQ,CACZC,gBAAgB,EAChBC,aAAc,SAAAC,GAGZ,OAFAnB,EAAWoB,QAAQD,GACnBnB,EAAWqB,YAAYF,EAAKG,MACE,OAA1BrB,EAAUsB,aACZC,IAAQC,QAAQ,2DACT,IAETC,OAAOP,KAAOA,EACT,4CAA4CQ,KAAKR,EAAKS,MAKvDT,EAAKU,KAAO,SACdL,IAAQM,MAAM,+BACP,GAGF,IAAIC,SAAQ,SAACC,EAASC,GAC3BjC,EAAWkC,SAASC,MAAK,SAACC,GACtBC,QAAQC,IAAI,4BACZN,EAAQI,MAEVG,OAAM,SAACT,GACPO,QAAQC,IAAI,4BACZL,EAAOH,UAhBTN,IAAQM,MAAM,iEACP,MA8Bb,OACE,6BACE,kBAAC,IAAD,CAAMU,IAAI,qBAAMC,SAAUzC,EAAW0C,aACnC,kBAACtD,EAAY4B,EACX,uBAAG2B,UAAU,wBACX,kBAACC,EAAA,EAAD,OAEF,uBAAGD,UAAU,mBAAb,gEACA,uBAAGA,UAAU,mBAAb,+GAMF3C,EAAWW,WAAa,kBAACrB,EAAD,KACtB,kBAACG,EAAD,iCACA,4BACE,wDAGA,4BACE,uBAAGoD,OAAO,SACPC,KAAM9C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,KAAMb,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,MAGjH,kDAGA,4BACGb,EAAW+C,UAEd,wDAGA,4BACE,kBAACpD,EAAD,CAAOqD,IAAKhD,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,OAE9D,wDAGA,4BACE,2BAAOoC,YAAY,mDAAWC,IAAKhD,EAAMiD,SAjD7B,WACtB9C,EAAMG,SAASN,EAAKkD,QAAQC,UAiDlB,2BAAOJ,YAAY,mDAAWC,IAAK9C,EAAM+C,SA9C5B,WACvB9C,EAAMK,UAAUN,EAAKgD,QAAQC,WA+CrB,4BACE,uBAAGR,OAAO,SAASC,KAAMzC,EAAMiD,SAAUjD,EAAMiD,YAGzC,S,0KCzIpB,IAAMC,EAAOhE,IAAOC,IAAV,KAmBKK,EAXGC,aAAS,YAAiB,IAAf0D,EAAc,EAAdA,SACpBvD,EAAaF,cAAbE,UACP,OACE,oCAEIA,EAAUsB,YAAc,KAAO,kBAACgC,EAAD,KAAOC,OCXxCC,EAAO3D,aAAS,WACAC,cAAbE,UAKP,OACE,oCACE,kBAAC,EAAD,mDACA,kBAACyD,EAAD,UAKSD","file":"static/js/10.cd70d1a3.chunk.js","sourcesContent":["import React, {useRef} from 'react'\nimport {useStores} from '../stores'\nimport {observer, useLocalStore} from 'mobx-react'\nimport {Upload, message, Spin} from 'antd'\nimport {InboxOutlined} from '@ant-design/icons'\nimport styled from 'styled-components'\n\n\nconst {Dragger} = Upload\n\nconst Result = styled.div`\n   margin-top: 30px;\n   border: 1px dashed #ccc;\n   padding:20px;\n`\n\nconst H1 = styled.h1`\n   margin:20px 0;\n   text-align: center;\n`\n\nconst Image = styled.img`\n   max-width: 300px;\n   \n`\n\n\nconst Component = observer(() => {\n  const {ImageStore, UserStore} = useStores()\n\n  const ref1 = useRef()\n  const ref2 = useRef()\n\n  const store = useLocalStore(() => ({\n    width: null,\n    setWidth(width) {\n      store.width = width;\n    },\n    get widthStr() {\n      return store.width ? `/w/${store.width}` : '';\n    },\n    height: null,\n    setHeight(height) {\n      store.height = height\n    },\n    get heightStr() {\n      return store.height ? `/w/${store.height}` : ''\n    },\n    get fullStr() {\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\n    }\n  }))\n  const props = {\n    showUploadList: false,\n    beforeUpload: file => {\n      ImageStore.setFile(file)\n      ImageStore.setFilename(file.name)\n      if (UserStore.currentUser === null) {\n        message.warning('请先登录之后再上传')\n        return false\n      }\n      window.file = file\n      if (!/(svg$)||(png$)||(jpg$)||(jpeg$)||(jif$)/ig.test(file.type)) {\n        message.error('请上传正确格式的图片')\n        return false\n      }\n\n      if (file.size > 1024 * 1024) {\n        message.error('图片最大1M')\n        return false\n      }\n\n      return new Promise((resolve, reject) => {\n        ImageStore.upload().then((serverfile) => {\n            console.log('上传成功')\n            resolve(serverfile)\n          }\n        ).catch((error) => {\n          console.log('上传失败')\n          reject(error)\n        })\n      })\n      return false\n    }\n  }\n\n  const bindWidthChange = () => {\n    store.setWidth(ref1.current.value)\n  }\n\n  const bindHeightChange = () => {\n    store.setHeight(ref2.current.value)\n  }\n\n  return (\n    <div>\n      <Spin tip=\"上传中\" spinning={ImageStore.isUploading}>\n        <Dragger {...props}>\n          <p className=\"ant-upload-drag-icon\">\n            <InboxOutlined/>\n          </p>\n          <p className=\"ant-upload-text\">点击或者拖拽图片上传</p>\n          <p className=\"ant-upload-hint\">\n            仅支持.png/.jpg/.gif/.svg格式的图片，图片最大1M。\n          </p>\n        </Dragger>\n      </Spin>\n      {\n        ImageStore.serverFile ? <Result>\n          <H1>上传结果</H1>\n          <dl>\n            <dt>\n              线上地址\n            </dt>\n            <dd>\n              <a target=\"_blank\"\n                 href={ImageStore.serverFile.attributes.url.attributes.url}>{ImageStore.serverFile.attributes.url.attributes.url}\n              </a>\n            </dd>\n            <dt>\n              文件名\n            </dt>\n            <dd>\n              {ImageStore.filename}\n            </dd>\n            <dt>\n              图片预览\n            </dt>\n            <dd>\n              <Image src={ImageStore.serverFile.attributes.url.attributes.url}/>\n            </dd>\n            <dt>\n              尺寸定制\n            </dt>\n            <dd>\n              <input placeholder=\"最大宽度（可选）\" ref={ref1} onChange={bindWidthChange}/>\n              <input placeholder=\"最大高度（可选）\" ref={ref2} onChange={bindHeightChange}/>\n            </dd>\n            <dd>\n              <a target=\"_blank\" href={store.fullStr}>{store.fullStr}</a>\n            </dd>\n          </dl>\n        </Result> : null\n      }\n    </div>\n  )\n})\n\nexport default Component","import React from 'react';\nimport {useStores} from '../stores';\nimport {observer} from 'mobx-react';\nimport styled from 'styled-components';\n\nconst Tips = styled.div`\n  background: orange;\n  padding: 10px;\n  margin: 30px 0;\n  color: #fff;\n  border-radius: 4px;\n`;\n\nconst Component = observer(({children}) => {\n  const {UserStore} = useStores()\n  return (\n    <>\n      {\n        UserStore.currentUser ? null : <Tips>{children}</Tips>\n      }\n    </>\n  )\n})\n\nexport default Component","import React from 'react';\nimport {observer} from 'mobx-react';\nimport {useStores} from '../stores';\nimport Uploader from '../components/Uploader';\nimport Tips from '../components/Tips'\n\n\nconst Home = observer(()=> {\n  const {UserStore} = useStores();\n  const User = ()=>\n    <div>\n      Hello {UserStore.currentUser.attributes.username}\n    </div>\n  return (\n    <>\n      <Tips>请先登录再上传</Tips>\n      <Uploader/>\n    </>\n  );\n});\n\nexport default Home;"],"sourceRoot":""}